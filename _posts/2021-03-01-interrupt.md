---
title: OS | 인터럽트(Interrupt)란?
tags: [OS, Interrupt]
date: 2021-03-01 08:11:00 +09:00
categories: [OS]
---

인터럽트가 왜 필요하고 발생시 어떤 작업을 하게 되는지 알아보겠습니다.

<!--more-->
---



#  인터럽트(Interrupt)란 무엇인가?

## 인터럽트! 왜 필요할까요?

컴퓨터에는 입출력장치라는 것이 있습니다. 컴퓨터로 정보를 입력해주는 장치(예: 키보드, 마우스 등)와 컴퓨터의 정보를 인간에게 보여주는 장치(예: 모니터, 프린터 등)가 있는데요. 이 장치와 정보를 주고받는 작업을 **입출력작업(I/O 작업)**이라고 합니다.
(보조기억장치(SSD, HDD)등에 데이터를 읽고 쓰는 작업 또한 입출력 작업입니다.)

이 입출력작업은 엄청 빈번하게 일어나는데요. 빈번할뿐만 아니라 작업의 속도가 느려서 CPU가 이 작업을 담당하면 작업시간보다 기다리는 시간이 더 많이 소요되게 됩니다.

안그래도 컴퓨터의 다른 연산등을 많이 담당하는 CPU가 이 작업까지 담당한다면 일이 너무 많아지기 때문에 **인터럽트**를 도입했습니다.

입출력작업이 잘 완료됐는지 CPU가 계속 지켜보고 있는것이 아니라 입출력장치에 작은 CPU(컨트롤러)를 만들어서 요청했던 입출력작업이 잘 완료된다면 CPU에게 작업이 완료됐다고 알려주는데 이 신호를 **인터럽트**라고 합니다.

인터럽트로 CPU에게 작업이 완료됐다고 알려줄 때 입출력장치가 완료된 작업물을 임시 저장하는 공간을 **로컬 버퍼**라고 부릅니다. 여기에 담긴 데이터는 인터럽트가 처리되면서 메모리로 옮겨지게 됩니다.

CPU는 하나의 명령이 끝날때마다 각 입출력장치로부터 연결된 **인터럽트 라인**을 통해 혹시 인터럽트가 들어와있는게 있는지 확인하고 있다면 이 인터럽트를 처리합니다.(어? 키보드가 정보를 넣어준게 있네? 이 정보를 처리해서 메모리에 저장해야겠다.)

## 인터럽트 발생시 어떻게 처리될까요?

운영체제의 핵심부분인 **커널**에는 인터럽트가 들어왔을대 CPU가 어떻게 일을 처리할지에 대한 내용이 미리 적혀져있습니다. 이를 **인터럽트 처리 루틴 혹은 인터럽트 서비스 루틴(Interrupt Service Routine, ISR)**이라고 합니다. 일종의 사용설명서이죠. CPU는 이 설명서를 보면서 인터럽트를 처리합니다.

이때 다른 프로세스를 처리중이던 CPU의 제어권은 잠시 운영체제에게 왔다가 인터럽트를 처리하기 위해 입출력장치로 넘어갑니다.

입출력장치의 인터럽트가 해결되면 처리하던 프로세스가 마저 처리되어야 하기 때문에 운영체제는 방금전까지 실행되던 프로세스의 정보를 잠시 다른곳에 저장해둡니다. 이를 PCB(Process Control Block)라고 합니다.
여기에 CPU가 처리하던 프로세스의 정보들(실행 중이던 코드의 메모리 주소, 레지스터값, 하드웨어 상태등)이 저장됩니다.
인터럽트의 처리가 끝난다면 이 PCB의 정보를 다시 불러와서 CPU는 처리하던 프로세스를 마저 수행합니다.

>**커널이란?**  
운영체제도 프로그램이기 때문에 사용되려면 메모리에 올라가있어야 합니다. 하지만 모든 코드가 메모리에 올라가 있다면 너무 비효율적이기 때문에 꼭 필요한 부분만 항상 메모리에 올라가있고 그 이외에 부분은 필요할 때 메모리에 올라갑니다.(예를들어 가끔씩 사용하는 계산기 프로그램이 항상 메모리에 올라가 있으면 안되겠죠?)   
이 때 이 메모리에 상주하는 핵심적인 부분을 **커널**이라고 합니다.


## 소프트웨어 인터럽트

위에서 언급한 입출력 장치로부터의 인터럽트를 **하드웨어 인터럽트**라고 합니다.
하드웨어(입출려장치)로부터의 인터럽트 말고도 소프트웨어로부터 발생되는 **소프트웨어 인터럽트**도 있습니다.
소프트웨어 인터럽트에는 **예외상황(exception)**과 **시스템 콜** 2가지가 있습니다.

- 예외 상황
  - 사용자 프로그램이 0으로 나누는 연 등 비정상적업 시도
  - 사용자 프로그램이 권한이 없는 운영체제의 코드에 접근해서 수정하려는 시도 등
-> 문제가 될 만한 상황이 발생시 운영체제가 해당 작업을 못하도록 CPU제어권을 가져감

- 시스템 콜
  - 사용자 프로그램이 운영체제만 할 수 있는 작업(입출력 작업)을 수행하기 위해 운영체제에게 요청하는 것
-> 운영체제만이 할수 있는 작업이기에 운영체제가 작업을 대신 수행하기 위해 CPU 제어권을 넘겨줌

위 두상황 모두 사용자 프로그램에게 있던 CPU제어권이 운영체제에게 넘어가게 되는데 이를 위해 인터럽트 라인을 세팅하는 명령을 실행하여 인터럽트를 발생키기 때문에 **소프트웨어 인터럽트**라고 분류됩니다.
